{% extends "hms/layout/base.html" %}
{% block title %}Dashboard - Ngenda Hotel{% endblock %}

{% block content %}
<div class="container-xl">
  <!-- Welcome Banner -->
  <div class="page-header d-print-none mb-3">
    <div class="row align-items-center">
      <div class="col">
        <div class="row g-3">
          <div class="col-auto">
            <span class="avatar avatar-xl" style="background-color: #206bc4; color: white; font-size: 1.5rem;">
              {{ current_user.email[0]|upper }}
            </span>
          </div>
          <div class="col">
            <h2 class="page-title">Welcome back, {{ current_user.name or current_user.email.split('@')[0]|title }}</h2>
            <div class="text-muted">
              Role: <span class="badge bg-{{ 'red' if user_role == 'superadmin' else 'blue' if user_role == 'manager' else 'green' if user_role == 'receptionist' else 'orange' if user_role in ['housekeeping', 'kitchen'] else 'purple' }}">{{ user_role|title }}</span>
              {% if active_hotel_id %}
                {% set hotel = hotels_for_selector[0] if hotels_for_selector else None %}
                {% if hotel %}
                  • Hotel: {{ hotel.name }}
                {% else %}
                  • Hotel: Assigned Hotel
                {% endif %}
              {% endif %}
            </div>
          </div>
        </div>
      </div>
      <div class="col-auto ms-auto d-print-none">
        <div class="btn-list">
          {% if quick_actions %}
            {% for action in quick_actions[:1] %}
            <a href="{{ action.url }}" class="btn btn-{{ action.color }} d-none d-sm-inline-block">
              <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                <line x1="12" y1="5" x2="12" y2="19" />
                <line x1="5" y1="12" x2="19" y2="12" />
              </svg>
              {{ action.label }}
            </a>
            {% endfor %}
          {% else %}
          <a href="{{ url_for('hms.bookings_new') }}" class="btn btn-primary d-none d-sm-inline-block">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
              <line x1="12" y1="5" x2="12" y2="19" />
              <line x1="5" y1="12" x2="19" y2="12" />
            </svg>
            New Booking
          </a>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <!-- Role-Based Quick Actions -->
  {% if quick_actions %}
  <div class="card mb-3">
    <div class="card-header">
      <h3 class="card-title">Quick Actions</h3>
      <div class="card-actions">
        <span class="badge bg-{{ 'red' if user_role == 'superadmin' else 'blue' if user_role == 'manager' else 'green' if user_role == 'receptionist' else 'orange' }}">{{ user_role|title }} Menu</span>
      </div>
    </div>
    <div class="card-body">
      <div class="row g-3">
        {% for action in quick_actions %}
        <div class="col-6 col-md-4 col-lg-2">
          <a href="{{ action.url }}" class="card card-sm card-link text-decoration-none hover-shadow">
            <div class="card-body">
              <div class="d-flex align-items-center">
                <span class="avatar avatar-lg bg-{{ action.color }}-lt text-{{ action.color }}">
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                    {% if action.icon == 'calendar-plus' %}<line x1="12" y1="5" x2="12" y2="19" /><line x1="5" y1="12" x2="19" y2="12" />
                    {% elif action.icon == 'login' %}<path d="M14 3v4a1 1 0 0 0 1 1h4" /><path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" /><path d="M9 17l3 3l3 -3" />
                    {% elif action.icon == 'users' %}<path d="M9 7m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0" /><path d="M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" /><path d="M16 3.13a4 4 0 0 1 0 7.75" /><path d="M21 21v-2a4 4 0 0 0 -3 -3.85" />
                    {% elif action.icon == 'settings' %}<path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" /><path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0" />
                    {% elif action.icon == 'chart' %}<path d="M9 5h10a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2z" /><path d="M9 12l2 2l4 -4" />
                    {% elif action.icon == 'broom' %}<path d="M19 11l-8 -8l-8.5 8.5a2.5 2.5 0 1 0 3.5 3.5l8.5 -8.5" /><path d="M12 3l8 8" />
                    {% elif action.icon == 'restaurant' %}<path d="M3 3h18v18h-18z" /><path d="M9 9l6 6" /><path d="M15 9l-6 6" />
                    {% elif action.icon == 'logout' %}<path d="M14 3v4a1 1 0 0 0 1 1h4" /><path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" /><path d="M9 17l-3 -3l3 -3" />
                    {% elif action.icon == 'tasks' %}<path d="M9 5h10a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2z" /><path d="M9 12l2 2l4 -4" /><path d="M9 7h6" /><path d="M9 17h6" />
                    {% elif action.icon == 'door' %}<path d="M14 3v4a1 1 0 0 0 1 1h4" /><path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" /><path d="M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
                    {% elif action.icon == 'alert' %}<path d="M12 9v2m0 4v.01" /><path d="M5 19h14a2 2 0 0 0 1.84 -2.75l-7.1 -12.25a2 2 0 0 0 -3.5 0l-7.1 12.25a2 2 0 0 0 1.75 2.75" />
                    {% elif action.icon == 'box' %}<path d="M12 3l8 4.5l0 9l-8 4.5l-8 -4.5l0 -9l8 -4.5" /><path d="M12 12l8 -4.5" /><path d="M12 12l0 9" /><path d="M12 12l-8 -4.5" /><path d="M16 5.25l-8 4.5" />
                    {% elif action.icon == 'check' %}<path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12l5 5l10 -10" />
                    {% elif action.icon == 'calendar' %}<path d="M12 3l8 4.5l0 9l-8 4.5l-8 -4.5l0 -9l8 -4.5" /><path d="M12 12l8 -4.5" /><path d="M12 12l0 9" /><path d="M12 12l-8 -4.5" /><path d="M16 5.25l-8 4.5" />
                    {% elif action.icon == 'kitchen' %}<path d="M3 21h18" /><path d="M5 21v-14l8 -4v18" /><path d="M19 21v-10l-6 -4" />
                    {% elif action.icon == 'list' %}<path d="M9 6l11 0" /><path d="M9 12l11 0" /><path d="M9 18l11 0" /><path d="M5 6l0 .01" /><path d="M5 12l0 .01" /><path d="M5 18l0 .01" />
                    {% elif action.icon == 'clipboard' %}<path d="M9 5h6a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-6a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2" /><path d="M9 3h6v4h-6z" /><path d="M9 12l2 0" /><path d="M9 16l2 0" />
                    {% elif action.icon == 'cash' %}<path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" /><path d="M12 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0" /><path d="M12 10v4" />
                    {% elif action.icon == 'menu' %}<path d="M4 6l16 0" /><path d="M4 12l16 0" /><path d="M4 18l16 0" />
                    {% elif action.icon == 'home' %}<path d="M5 12l-2 0l9 -9l9 9l-2 0" /><path d="M5 12l6 0l6 -6" /><path d="M5 12l6 0l6 6" />
                    {% else %}<circle cx="12" cy="12" r="9" />
                    {% endif %}
                  </svg>
                </span>
                <div class="ms-3">
                  <div class="text-muted" style="font-size: 0.75rem;">Quick Action</div>
                  <div class="text-reset" style="font-weight: 500;">{{ action.label }}</div>
                </div>
              </div>
            </div>
          </a>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
  {% endif %}

  <!-- Hotel Selector -->
  {% if hotels_for_selector %}
  <div class="card mb-3">
    <div class="card-body">
      <div class="row align-items-center">
        <div class="col-auto">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon text-blue" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 21h18" />
            <path d="M5 21v-14l8 -4v18" />
            <path d="M19 21v-10l-6 -4" />
          </svg>
        </div>
        <div class="col">
          <h3 class="card-title">Select Hotel</h3>
          <div class="text-muted">Choose which property to manage</div>
        </div>
        <div class="col-auto">
          <a href="{{ '#' }}" class="btn btn-outline-primary btn-sm">View All</a>
          {% for h in hotels_for_selector %}
          <a href="{{ url_for('core.set_hotel', hotel_id=h.id) }}" class="btn {% if active_hotel_id == h.id %}btn-primary{% else %}btn-outline-secondary{% endif %} btn-sm ms-1">{{ h.name }}</a>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
  {% endif %}

  <!-- Quick Stats Cards -->
  <div class="row row-deck row-cards mb-3">
    <div class="col-sm-6 col-lg-3">
      <div class="card card-sm">
        <div class="card-body">
          <div class="row align-items-center">
            <div class="col-auto">
              <span class="bg-blue text-white avatar">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                  <path d="M5 11h14a2 2 0 0 1 2 2v7a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-7a2 2 0 0 1 2 -2z" />
                  <path d="M12 3v3" />
                  <path d="M10 7v-2a2 2 0 1 1 4 0v2" />
                </svg>
              </span>
            </div>
            <div class="col">
              <div class="font-weight-medium">Total Rooms</div>
              <div class="text-muted">{{ stats.total_rooms }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-sm-6 col-lg-3">
      <div class="card card-sm">
        <div class="card-body">
          <div class="row align-items-center">
            <div class="col-auto">
              <span class="bg-green text-white avatar">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                  <path d="M5 11h14a2 2 0 0 1 2 2v7a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-7a2 2 0 0 1 2 -2z" />
                  <path d="M12 3v3" />
                  <path d="M10 7v-2a2 2 0 1 1 4 0v2" />
                  <path d="M8 14v-2" />
                  <path d="M16 14v-2" />
                  <path d="M10 14v-2" />
                  <path d="M14 14v-2" />
                </svg>
              </span>
            </div>
            <div class="col">
              <div class="font-weight-medium">Occupied</div>
              <div class="text-muted">{{ stats.occupied_rooms }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-sm-6 col-lg-3">
      <div class="card card-sm">
        <div class="card-body">
          <div class="row align-items-center">
            <div class="col-auto">
              <span class="bg-orange text-white avatar">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                  <path d="M14 3v4a1 1 0 0 0 1 1h4" />
                  <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" />
                  <path d="M9 7l1 1l1 -1m-2 1l1 1l1 -1" />
                  <path d="M9 11l1 1l1 -1m-2 1l1 1l1 -1" />
                  <path d="M9 15l1 1l1 -1" />
                </svg>
              </span>
            </div>
            <div class="col">
              <div class="font-weight-medium">Today's Revenue</div>
              <div class="text-muted">${{ "%.2f"|format(stats.revenue_today) }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-sm-6 col-lg-3">
      <div class="card card-sm">
        <div class="card-body">
          <div class="row align-items-center">
            <div class="col-auto">
              <span class="bg-purple text-white avatar">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                  <path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 3.35a1.724 1.724 0 0 0 1.066 2.573c-.94 1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" />
                  <path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0" />
                </svg>
              </span>
            </div>
            <div class="col">
              <div class="font-weight-medium">Total Bookings</div>
              <div class="text-muted">{{ stats.total_bookings }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content Grid -->
  <div class="row row-deck row-cards">
    <!-- Left Column - Charts -->
    <div class="col-lg-8">
      <!-- Revenue Chart -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">Revenue Overview</h3>
          <div class="card-actions">
            <div class="dropdown">
              <a href="#" class="dropdown-toggle" data-bs-toggle="dropdown">Last 30 Days</a>
              <div class="dropdown-menu dropdown-menu-end">
                <a class="dropdown-item" href="#">Last 7 Days</a>
                <a class="dropdown-item" href="#">Last 30 Days</a>
                <a class="dropdown-item" href="#">Last 90 Days</a>
              </div>
            </div>
          </div>
        </div>
        <div class="card-body">
          <div id="revenue-chart" style="height: 300px;"></div>
        </div>
      </div>

      <!-- Quick Actions -->
      <div class="card mt-3">
        <div class="card-header">
          <h3 class="card-title">Quick Actions</h3>
        </div>
        <div class="card-body">
          <div class="row row-cards">
            <div class="col-sm-6 col-lg-3">
              <a href="{{ url_for('hms.bookings_new') }}" class="text-decoration-none">
                <div class="card card-sm bg-blue-lt">
                  <div class="card-body text-center">
                    <div class="mb-3">
                      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-lg text-blue" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                        <line x1="12" y1="5" x2="12" y2="19" />
                        <line x1="5" y1="12" x2="19" y2="12" />
                      </svg>
                    </div>
                    <h4 class="m-0">New Booking</h4>
                    <div class="text-muted">Create reservation</div>
                  </div>
                </div>
              </a>
            </div>
            <div class="col-sm-6 col-lg-3">
              <a href="{{ url_for('hms.rooms') }}" class="text-decoration-none">
                <div class="card card-sm bg-green-lt">
                  <div class="card-body text-center">
                    <div class="mb-3">
                      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-lg text-green" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                        <path d="M5 11h14a2 2 0 0 1 2 2v7a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-7a2 2 0 0 1 2 -2z" />
                        <path d="M12 3v3" />
                        <path d="M10 7v-2a2 2 0 1 1 4 0v2" />
                      </svg>
                    </div>
                    <h4 class="m-0">Room Status</h4>
                    <div class="text-muted">View room status</div>
                  </div>
                </div>
              </a>
            </div>
            <div class="col-sm-6 col-lg-3">
              <a href="{{ url_for('hms.housekeeping') }}" class="text-decoration-none">
                <div class="card card-sm bg-orange-lt">
                  <div class="card-body text-center">
                    <div class="mb-3">
                      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-lg text-orange" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                        <path d="M14 3v4a1 1 0 0 0 1 1h4" />
                        <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" />
                        <path d="M9 7l1 1l1 -1m-2 1l1 1l1 -1" />
                        <path d="M9 11l1 1l1 -1m-2 1l1 1l1 -1" />
                        <path d="M9 15l1 1l1 -1" />
                      </svg>
                    </div>
                    <h4 class="m-0">Housekeeping</h4>
                    <div class="text-muted">Manage tasks</div>
                  </div>
                </div>
              </a>
            </div>
            <div class="col-sm-6 col-lg-3">
              <a href="{{ url_for('hms.accounting') }}" class="text-decoration-none">
                <div class="card card-sm bg-purple-lt">
                  <div class="card-body text-center">
                    <div class="mb-3">
                      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-lg text-purple" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                        <path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 3.35a1.724 1.724 0 0 0 1.066 2.573c-.94 1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" />
                        <path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0" />
                      </svg>
                    </div>
                    <h4 class="m-0">Financials</h4>
                    <div class="text-muted">View reports</div>
                  </div>
                </div>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Column - Stats and Recent Activity -->
    <div class="col-lg-4">
      <!-- Today's Stats -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">Today's Activity</h3>
        </div>
        <div class="list-group list-group-flush">
          <div class="list-group-item">
            <div class="row align-items-center">
              <div class="col-auto">
                <span class="bg-blue text-white avatar">
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                    <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" />
                    <path d="M12 8v4l2 2" />
                  </svg>
                </span>
              </div>
              <div class="col">
                <div>Check-ins</div>
                <div class="text-muted">{{ stats.check_ins_today }}</div>
              </div>
            </div>
          </div>
          <div class="list-group-item">
            <div class="row align-items-center">
              <div class="col-auto">
                <span class="bg-green text-white avatar">
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                    <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" />
                    <path d="M12 8v4l2 2" />
                  </svg>
                </span>
              </div>
              <div class="col">
                <div>Check-outs</div>
                <div class="text-muted">{{ stats.check_outs_today }}</div>
              </div>
            </div>
          </div>
          <div class="list-group-item">
            <div class="row align-items-center">
              <div class="col-auto">
                <span class="bg-orange text-white avatar">
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                    <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" />
                    <path d="M12 8v4l2 2" />
                  </svg>
                </span>
              </div>
              <div class="col">
                <div>Occupancy Rate</div>
                <div class="text-muted">{{ stats.occupancy_rate }}%</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Recent Bookings -->
      <div class="card mt-3">
        <div class="card-header">
          <h3 class="card-title">Recent Bookings</h3>
          <div class="card-actions">
            <a href="{{ url_for('hms.bookings') }}" class="btn btn-outline-primary btn-sm">View All</a>
          </div>
        </div>
        <div class="list-group list-group-flush">
          {% for booking in recent_bookings %}
          <div class="list-group-item">
            <div class="row align-items-center">
              <div class="col-auto">
                <span class="bg-blue text-white avatar">
                  {{ booking.guest.name[0]|upper if booking.guest else 'G' }}
                </span>
              </div>
              <div class="col">
                <div class="font-weight-medium">{{ booking.guest.name if booking.guest else 'Unknown' }}</div>
                <div class="text-muted">{{ booking.room.room_number if booking.room else 'N/A' }} • {{ booking.check_in_date.strftime('%b %d') }} - {{ booking.check_out_date.strftime('%b %d') }}</div>
              </div>
              <div class="col-auto">
                <span class="badge bg-{{ 'green' if booking.status == 'confirmed' else 'blue' if booking.status == 'pending' else 'red' }}-lt">{{ booking.status|title }}</span>
              </div>
            </div>
          </div>
          {% else %}
          <div class="list-group-item text-center">
            <div class="text-muted">No recent bookings</div>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>

  <!-- Bottom Row - Upcoming Events and Alerts -->
  <div class="row row-deck row-cards mt-3">
    <!-- Upcoming Events -->
    <div class="col-lg-6">
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">Upcoming Events</h3>
        </div>
        <div class="list-group list-group-flush">
          {% for event in upcoming_events %}
          <div class="list-group-item">
            <div class="row align-items-center">
              <div class="col-auto">
                <span class="bg-blue text-white avatar">
                  {{ event.date.strftime('%d') }}
                </span>
              </div>
              <div class="col">
                <div class="font-weight-medium">{{ event.title }}</div>
                <div class="text-muted">{{ event.date.strftime('%B %d, %Y') }} • {{ event.description }}</div>
              </div>
              <div class="col-auto">
                <span class="badge bg-blue-lt">{{ event.type|title }}</span>
              </div>
            </div>
          </div>
          {% else %}
          <div class="list-group-item text-center">
            <div class="text-muted">No upcoming events</div>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>

    <!-- Alerts & Notifications -->
    <div class="col-lg-6">
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">Alerts & Notifications</h3>
        </div>
        <div class="list-group list-group-flush">
          {% for alert in alerts %}
          <div class="list-group-item">
            <div class="row align-items-center">
              <div class="col-auto">
                <span class="bg-{{ alert.level }} text-white avatar">
                  {% if alert.type == 'low_stock' %}
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                    <path d="M12 17.5l-7 -4.5v-9l7 4.5l7 -4.5v9l-7 4.5z" />
                    <path d="M4 12l7 4.5l7 -4.5" />
                  </svg>
                  {% elif alert.type == 'maintenance' %}
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                    <path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 3.35a1.724 1.724 0 0 0 1.066 2.573c-.94 1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" />
                    <path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0" />
                  </svg>
                  {% else %}
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                    <circle cx="12" cy="12" r="9" />
                    <line x1="12" y1="8" x2="12" y2="12" />
                    <line x1="12" y1="16" x2="12.01" y2="16" />
                  </svg>
                  {% endif %}
                </span>
              </div>
              <div class="col">
                <div class="font-weight-medium">{{ alert.title }}</div>
                <div class="text-muted">{{ alert.message }}</div>
              </div>
              <div class="col-auto">
                <span class="badge bg-{{ alert.level }}-lt">{{ alert.severity|title }}</span>
              </div>
            </div>
          </div>
          {% else %}
          <div class="list-group-item text-center">
            <div class="text-muted">No alerts</div>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
<script>
// Initialize charts
document.addEventListener('DOMContentLoaded', function() {
  // Revenue Chart
  var revenueChartOptions = {
    chart: {
      type: 'area',
      height: 300,
      toolbar: {
        show: false
      }
    },
    series: [{
      name: 'Revenue',
      data: {{ revenue_data|tojson }}
    }],
    xaxis: {
      categories: {{ revenue_labels|tojson }}
    },
    colors: ['#206bc4'],
    fill: {
      type: 'gradient',
      gradient: {
        shadeIntensity: 1,
        opacityFrom: 0.7,
        opacityTo: 0.1,
        stops: [0, 100]
      }
    },
    tooltip: {
      x: {
        format: 'dd/MM/yy HH:mm'
      },
      y: {
        formatter: function (val) {
          return "$" + val
        }
      }
    },
    dataLabels: {
      enabled: false
    },
    stroke: {
      curve: 'smooth',
      width: 2
    }
  };

  var revenueChart = new ApexCharts(document.querySelector("#revenue-chart"), revenueChartOptions);
  revenueChart.render();
});
</script>
{% endblock %}